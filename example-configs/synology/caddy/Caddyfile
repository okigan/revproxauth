{
    # Synology handles HTTPS, so disable Caddy's automatic HTTPS
    auto_https off
}

# Protected sites
your-domain.example.com:80 {  # CHANGE THIS to your actual domain!
    # Define auth-exempt paths (login/logout don't require authentication)
    @auth_exempt path /login /login/* /do-login /logout
    
    # Handle auth-exempt paths without authentication
    handle @auth_exempt {
        reverse_proxy radius-auth-go:8999 {
            header_up X-Forwarded-Proto https
        }
    }
    
    # Everything else requires authentication
    handle {
        forward_auth radius-auth-go:8999 {
            uri /auth
            copy_headers X-Auth-User
            header_up X-Forwarded-Proto https
        }
        reverse_proxy http://your-backend:8080  # CHANGE THIS to your backend!
    }
}